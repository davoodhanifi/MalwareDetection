from datetime import datetime
import numpy as np
import logging
import csv
from sklearn.metrics import accuracy_score, f1_score, precision_score, recall_score, classification_report, confusion_matrix

def build_test(feature_selection_model, model):
    file = open("./Data/test.csv", 'rb')
    rows = csv.reader(file)
    data = []
    lables = []
    for row in rows:
        data.append(row[1:])
        lables.append(int(row[0]))

    print 'Start Time: '+ str(datetime.now())
    print "Test Model... "

    new_data = feature_selection_model.transform(data)
    predicts = []
    i = 0
    for item in new_data:
        pData = np.array(item).reshape(1,-1)
        pred = model.predict(pData)
        predicts.append(int(pred[0]))
        i += 1

    y_test = lables
    y_pred = np.array(predicts)

    print  "F1score:", f1_score(y_test, y_pred, average="macro") 
    print "Precision:", precision_score(y_test, y_pred, average="macro") 
    print "Recall:", recall_score(y_test, y_pred, average="macro")

    print "Test Done!"
    print 'End Time: '+ str(datetime.now())
